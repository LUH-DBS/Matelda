"0","# Make half the data frame for the graph."
"0","chi.graph <- left_join(diet.items, centroids.sf, by=c('site')) %>% "
"0","  group_by(source, zone) %>% "
"0","  mutate(total.count=n()) %>% "
"0","  distinct(source, zone, total.count) %>% "
"0","  pivot_wider(names_from=source, values_from=total.count) %>% "
"0","  mutate(RP=R + P) %>% "
"0","  pivot_longer(!zone, names_to='source', values_to='total.count')"
"0",""
"0","# Make the other half of the data frame, then join."
"0","chi.graph <- left_join(diet.items, centroids.sf, by=c('site')) %>% "
"0","  group_by(source, zone, group) %>% "
"0","  mutate(group.count=n()) %>% "
"0","  distinct(source, zone, group, group.count) %>% "
"0","  pivot_wider(names_from=source, values_from=group.count, values_fill=0) %>% "
"0","  mutate(RP=R + P) %>% "
"0","  pivot_longer(-c(group, zone), names_to='source', values_to='group.count') %>% "
"0","  right_join(chi.graph, by=c('zone', 'source')) %>% "
"0","  filter(source != 'R') %>% "
"0","  mutate(prop=group.count/total.count)"
"0",""
"0","# Source names for facet labels."
"0","source_names <- list("
"0","  'C'='Cameras',"
"0","  'P'='Pellets',"
"0","  'RP'='Pooled'"
"0",")"
"0",""
"0","# Labeller function."
"0","labeller <- function(variable, value) {"
"0","  return(source_names[value])"
"0","}"
"0",""
"0","# Graph it."
"0","chi.graph %>% "
"0","  ggplot(aes(x=group, y=prop, fill=zone)) +"
"0","  geom_bar(stat='identity', position='dodge') +"
"0","  theme_classic() +"
"0","  facet_grid(source ~., labeller=labeller) +"
"0","  theme(legend.position='bottom',"
"0","        legend.title=element_blank()) +"
"0","  scale_fill_manual(labels=c('Coastal', 'Transition'), values=c('darkgrey', 'dimgrey')) +"
"0","  xlab('Prey category') +"
"0","  ylab('Proportion of items')"
